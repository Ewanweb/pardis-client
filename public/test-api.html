<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ØªØ³Øª API URL</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        padding: 20px;
        background: #f5f5f5;
      }
      .container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .result {
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
        font-family: monospace;
      }
      .success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
      button {
        background: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background: #0056b3;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ” ØªØ³Øª API URL</h1>

      <div id="results"></div>

      <button onclick="testApiUrl()">ØªØ³Øª API URL</button>
      <button onclick="testConnection()">ØªØ³Øª Ø§ØªØµØ§Ù„</button>
      <button onclick="clearResults()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬</button>

      <h3>Ø±Ø§Ù‡Ù†Ù…Ø§:</h3>
      <ul>
        <li>Ø§Ú¯Ø± API URL Ù‡Ù†ÙˆØ² localhost Ø§Ø³ØªØŒ cache Ù…Ø±ÙˆØ±Ú¯Ø± Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯</li>
        <li>Ø³Ø±ÙˆØ± Ø±Ø§ restart Ú©Ù†ÛŒØ¯: <code>npm run dev</code></li>
        <li>Ø§Ú¯Ø± Ù…Ø´Ú©Ù„ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ø§Ø´ØªØŒ ÙØ§ÛŒÙ„ .env.local Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯</li>
      </ul>
    </div>

    <script type="module">
      window.testApiUrl = async function () {
        const results = document.getElementById("results");

        try {
          // Import API configuration
          const { ApiManager } = await import("/src/services/api.js");

          const config = ApiManager.getConfig();

          results.innerHTML += `
                    <div class="result info">
                        <strong>ğŸ“Š ØªÙ†Ø¸ÛŒÙ…Ø§Øª API:</strong><br>
                        Server URL: ${config.serverUrl}<br>
                        API URL: ${config.apiUrl}<br>
                        Timeout: ${config.timeout}ms<br>
                        Environment: ${import.meta.env.MODE}
                    </div>
                `;

          // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø¢ÛŒØ§ Ù‡Ù†ÙˆØ² localhost Ø§Ø³Øª
          if (
            config.apiUrl.includes("localhost") ||
            config.apiUrl.includes("127.0.0.1")
          ) {
            results.innerHTML += `
                        <div class="result error">
                            âŒ <strong>Ù…Ø´Ú©Ù„:</strong> API URL Ù‡Ù†ÙˆØ² localhost Ø§Ø³Øª!<br>
                            Ù„Ø·ÙØ§Ù‹ cache Ù…Ø±ÙˆØ±Ú¯Ø± Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯ Ùˆ Ø³Ø±ÙˆØ± Ø±Ø§ restart Ú©Ù†ÛŒØ¯.
                        </div>
                    `;
          } else {
            results.innerHTML += `
                        <div class="result success">
                            âœ… <strong>Ù…ÙˆÙÙ‚:</strong> API URL Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯Ù‡ Ø§Ø³Øª.
                        </div>
                    `;
          }
        } catch (error) {
          results.innerHTML += `
                    <div class="result error">
                        âŒ <strong>Ø®Ø·Ø§:</strong> ${error.message}
                    </div>
                `;
        }
      };

      window.testConnection = async function () {
        const results = document.getElementById("results");

        try {
          const { ApiManager } = await import("/src/services/api.js");

          results.innerHTML += `
                    <div class="result info">
                        ğŸ§ª Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª Ø§ØªØµØ§Ù„...
                    </div>
                `;

          const testResult = await ApiManager.testConnection();

          if (testResult.success) {
            results.innerHTML += `
                        <div class="result success">
                            âœ… <strong>Ø§ØªØµØ§Ù„ Ù…ÙˆÙÙ‚!</strong><br>
                            ${JSON.stringify(testResult.data, null, 2)}
                        </div>
                    `;
          } else {
            results.innerHTML += `
                        <div class="result error">
                            âŒ <strong>Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„:</strong> ${testResult.error}
                        </div>
                    `;
          }
        } catch (error) {
          results.innerHTML += `
                    <div class="result error">
                        âŒ <strong>Ø®Ø·Ø§:</strong> ${error.message}
                    </div>
                `;
        }
      };

      window.clearResults = function () {
        document.getElementById("results").innerHTML = "";
      };

      // ØªØ³Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ù†Ú¯Ø§Ù… Ù„ÙˆØ¯ ØµÙØ­Ù‡
      window.addEventListener("load", () => {
        setTimeout(testApiUrl, 500);
      });
    </script>
  </body>
</html>
