<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advanced API Debug Console - Pardis Client</title>
    <link rel="icon" href="/fav.png" type="image/png" />
    <style>
      :root {
        --primary: #4f46e5;
        --primary-dark: #3730a3;
        --secondary: #7c3aed;
        --success: #10b981;
        --warning: #f59e0b;
        --error: #ef4444;
        --info: #3b82f6;
        --dark: #1f2937;
        --light: #f8fafc;
        --border: #e5e7eb;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        --radius: 12px;
        --radius-lg: 20px;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        color: var(--dark);
        line-height: 1.6;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        background: white;
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-lg);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 100%
        );
        color: white;
        padding: 40px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        opacity: 0.3;
      }

      .header-content {
        position: relative;
        z-index: 1;
      }

      .header h1 {
        font-size: 3rem;
        margin-bottom: 15px;
        font-weight: 800;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .header p {
        opacity: 0.95;
        font-size: 1.2rem;
        font-weight: 300;
      }

      .status-bar {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px 40px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .status-item {
        display: flex;
        align-items: center;
        gap: 8px;
        color: white;
        font-size: 0.9rem;
      }

      .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: var(--success);
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      .content {
        padding: 40px;
        background: #fafbfc;
      }

      .tabs {
        display: flex;
        background: white;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        margin-bottom: 30px;
        overflow: hidden;
      }

      .tab {
        flex: 1;
        padding: 15px 20px;
        background: transparent;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        color: #6b7280;
        transition: all 0.3s ease;
        position: relative;
      }

      .tab.active {
        color: var(--primary);
        background: #f8fafc;
      }

      .tab.active::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: var(--primary);
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .section {
        background: white;
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        margin-bottom: 30px;
        overflow: hidden;
      }

      .section-header {
        padding: 25px 30px;
        border-bottom: 1px solid var(--border);
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      }

      .section-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--dark);
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .section-body {
        padding: 30px;
      }

      .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 25px;
        margin-bottom: 30px;
      }

      .metric-card {
        background: white;
        border: 2px solid var(--border);
        border-radius: var(--radius);
        padding: 25px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .metric-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary), var(--secondary));
      }

      .metric-card:hover {
        border-color: var(--primary);
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .metric-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 15px;
      }

      .metric-icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
      }

      .metric-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--dark);
      }

      .metric-value {
        font-size: 2rem;
        font-weight: 800;
        color: var(--primary);
        margin-bottom: 8px;
      }

      .metric-description {
        color: #6b7280;
        font-size: 0.9rem;
      }

      .api-endpoints {
        display: grid;
        gap: 20px;
      }

      .endpoint-card {
        background: white;
        border: 1px solid var(--border);
        border-radius: var(--radius);
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .endpoint-card:hover {
        box-shadow: var(--shadow-lg);
      }

      .endpoint-header {
        padding: 20px 25px;
        background: #f8fafc;
        border-bottom: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .endpoint-method {
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 0.8rem;
        font-weight: 700;
        text-transform: uppercase;
      }

      .method-get {
        background: #dcfce7;
        color: #166534;
      }
      .method-post {
        background: #dbeafe;
        color: #1e40af;
      }
      .method-put {
        background: #fef3c7;
        color: #92400e;
      }
      .method-delete {
        background: #fee2e2;
        color: #991b1b;
      }

      .endpoint-url {
        font-family: "Courier New", monospace;
        font-size: 0.9rem;
        color: var(--dark);
        font-weight: 600;
      }

      .endpoint-body {
        padding: 25px;
      }

      .endpoint-description {
        color: #6b7280;
        margin-bottom: 20px;
      }

      .test-controls {
        display: flex;
        gap: 15px;
        align-items: center;
        flex-wrap: wrap;
      }

      .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 600;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        position: relative;
        overflow: hidden;
      }

      .btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .btn:hover::before {
        left: 100%;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-dark)
        );
        color: white;
      }

      .btn-success {
        background: linear-gradient(135deg, var(--success), #059669);
        color: white;
      }

      .btn-warning {
        background: linear-gradient(135deg, var(--warning), #d97706);
        color: white;
      }

      .btn-danger {
        background: linear-gradient(135deg, var(--error), #dc2626);
        color: white;
      }

      .btn-secondary {
        background: linear-gradient(135deg, #6b7280, #4b5563);
        color: white;
      }

      .status {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
      }

      .status.success {
        background: #dcfce7;
        color: #166534;
      }

      .status.error {
        background: #fee2e2;
        color: #991b1b;
      }

      .status.warning {
        background: #fef3c7;
        color: #92400e;
      }

      .status.info {
        background: #dbeafe;
        color: #1e40af;
      }

      .console {
        background: #1f2937;
        border-radius: var(--radius);
        padding: 25px;
        margin-top: 25px;
        font-family: "Courier New", monospace;
        font-size: 0.9rem;
        color: #e5e7eb;
        max-height: 400px;
        overflow-y: auto;
        position: relative;
      }

      .console-header {
        display: flex;
        justify-content: between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 15px;
        border-bottom: 1px solid #374151;
      }

      .console-title {
        color: #9ca3af;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .console-controls {
        display: flex;
        gap: 10px;
      }

      .console-btn {
        background: #374151;
        border: none;
        color: #9ca3af;
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 0.8rem;
        cursor: pointer;
        transition: all 0.2s;
      }

      .console-btn:hover {
        background: #4b5563;
        color: white;
      }

      .log-entry {
        margin-bottom: 8px;
        padding: 8px 0;
        border-bottom: 1px solid #374151;
      }

      .log-timestamp {
        color: #6b7280;
        font-size: 0.8rem;
      }

      .log-level {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.7rem;
        font-weight: bold;
        margin: 0 8px;
      }

      .log-info {
        background: #1e40af;
        color: white;
      }
      .log-success {
        background: #059669;
        color: white;
      }
      .log-warning {
        background: #d97706;
        color: white;
      }
      .log-error {
        background: #dc2626;
        color: white;
      }

      .real-time-monitor {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .monitor-item {
        background: white;
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 20px;
        text-align: center;
      }

      .monitor-value {
        font-size: 2.5rem;
        font-weight: 800;
        color: var(--primary);
        margin-bottom: 8px;
      }

      .monitor-label {
        color: #6b7280;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid #f3f3f3;
        border-top: 3px solid var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .progress-bar {
        width: 100%;
        height: 8px;
        background: #e5e7eb;
        border-radius: 4px;
        overflow: hidden;
        margin: 15px 0;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        border-radius: 4px;
        transition: width 0.3s ease;
        width: 0%;
      }

      @media (max-width: 768px) {
        .container {
          margin: 10px;
          border-radius: var(--radius);
        }

        .header {
          padding: 30px 20px;
        }

        .header h1 {
          font-size: 2rem;
        }

        .content {
          padding: 20px;
        }

        .metrics-grid {
          grid-template-columns: 1fr;
        }

        .tabs {
          flex-direction: column;
        }

        .status-bar {
          flex-direction: column;
          gap: 10px;
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="header-content">
          <h1>üöÄ Advanced API Debug Console</h1>
          <p>ÿ≥€åÿ≥ÿ™ŸÖ Ÿæ€åÿ¥ÿ±ŸÅÿ™Ÿá ŸÖÿßŸÜ€åÿ™Ÿàÿ±€åŸÜ⁄Ø Ÿà ÿ™ÿ≥ÿ™ API ÿ®ÿ±ÿß€å ŸÖÿ≠€åÿ∑ Production</p>
        </div>
      </div>

      <div class="status-bar">
        <div class="status-item">
          <div class="status-dot"></div>
          <span>API Status: <strong id="api-status">Checking...</strong></span>
        </div>
        <div class="status-item">
          <span>Last Update: <strong id="last-update">--:--:--</strong></span>
        </div>
        <div class="status-item">
          <span>Response Time: <strong id="response-time">-- ms</strong></span>
        </div>
        <div class="status-item">
          <span>Requests: <strong id="request-count">0</strong></span>
        </div>
      </div>

      <div class="content">
        <div class="tabs">
          <button class="tab active" onclick="switchTab('overview')">
            üìä Overview
          </button>
          <button class="tab" onclick="switchTab('endpoints')">
            üîó API Endpoints
          </button>
          <button class="tab" onclick="switchTab('monitoring')">
            üìà Real-time Monitor
          </button>
          <button class="tab" onclick="switchTab('cache')">
            üßπ Cache Management
          </button>
          <button class="tab" onclick="switchTab('system')">
            ‚öôÔ∏è System Info
          </button>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
          <div class="metrics-grid">
            <div class="metric-card">
              <div class="metric-header">
                <div
                  class="metric-icon"
                  style="background: #dcfce7; color: #166534"
                >
                  üìä
                </div>
                <div class="metric-title">API Health</div>
              </div>
              <div class="metric-value" id="health-score">--</div>
              <div class="metric-description">Overall system health score</div>
            </div>

            <div class="metric-card">
              <div class="metric-header">
                <div
                  class="metric-icon"
                  style="background: #dbeafe; color: #1e40af"
                >
                  ‚ö°
                </div>
                <div class="metric-title">Average Response</div>
              </div>
              <div class="metric-value" id="avg-response">-- ms</div>
              <div class="metric-description">Average API response time</div>
            </div>

            <div class="metric-card">
              <div class="metric-header">
                <div
                  class="metric-icon"
                  style="background: #fef3c7; color: #92400e"
                >
                  üì¶
                </div>
                <div class="metric-title">Cache Size</div>
              </div>
              <div class="metric-value" id="cache-size-display">-- KB</div>
              <div class="metric-description">Total application cache size</div>
            </div>

            <div class="metric-card">
              <div class="metric-header">
                <div
                  class="metric-icon"
                  style="background: #f3e8ff; color: #7c3aed"
                >
                  üîÑ
                </div>
                <div class="metric-title">App Version</div>
              </div>
              <div class="metric-value" id="app-version-display">
                VERSION_PLACEHOLDER
              </div>
              <div class="metric-description">Current application version</div>
            </div>
          </div>

          <div class="section">
            <div class="section-header">
              <div class="section-title">üéØ Quick Actions</div>
            </div>
            <div class="section-body">
              <div class="test-controls">
                <button class="btn btn-primary" onclick="runHealthCheck()">
                  <span
                    class="loading"
                    id="health-loading"
                    style="display: none"
                  ></span>
                  üè• Health Check
                </button>
                <button class="btn btn-success" onclick="testAllEndpoints()">
                  <span
                    class="loading"
                    id="test-loading"
                    style="display: none"
                  ></span>
                  üß™ Test All APIs
                </button>
                <button class="btn btn-warning" onclick="clearAllCache()">
                  üóëÔ∏è Clear Cache
                </button>
                <button class="btn btn-secondary" onclick="exportLogs()">
                  üì• Export Logs
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- API Endpoints Tab -->
        <div id="endpoints" class="tab-content">
          <div class="section">
            <div class="section-header">
              <div class="section-title">üîó Available API Endpoints</div>
            </div>
            <div class="section-body">
              <div class="api-endpoints" id="endpoints-list">
                <!-- Endpoints will be populated by JavaScript -->
              </div>
            </div>
          </div>
        </div>

        <!-- Real-time Monitoring Tab -->
        <div id="monitoring" class="tab-content">
          <div class="real-time-monitor">
            <div class="monitor-item">
              <div class="monitor-value" id="live-requests">0</div>
              <div class="monitor-label">Live Requests</div>
            </div>
            <div class="monitor-item">
              <div class="monitor-value" id="success-rate">100%</div>
              <div class="monitor-label">Success Rate</div>
            </div>
            <div class="monitor-item">
              <div class="monitor-value" id="error-count">0</div>
              <div class="monitor-label">Errors</div>
            </div>
            <div class="monitor-item">
              <div class="monitor-value" id="uptime">00:00:00</div>
              <div class="monitor-label">Uptime</div>
            </div>
          </div>

          <div class="section">
            <div class="section-header">
              <div class="section-title">üìà Performance Metrics</div>
            </div>
            <div class="section-body">
              <canvas id="performance-chart" width="400" height="200"></canvas>
            </div>
          </div>

          <div class="section">
            <div class="section-header">
              <div class="section-title">üìù Live Console</div>
            </div>
            <div class="section-body">
              <div class="console">
                <div class="console-header">
                  <div class="console-title">System Logs</div>
                  <div class="console-controls">
                    <button class="console-btn" onclick="clearConsole()">
                      Clear
                    </button>
                    <button class="console-btn" onclick="pauseConsole()">
                      Pause
                    </button>
                    <button class="console-btn" onclick="exportLogs()">
                      Export
                    </button>
                  </div>
                </div>
                <div id="console-output">
                  <div class="log-entry">
                    <span class="log-timestamp">[--:--:--]</span>
                    <span class="log-level log-info">INFO</span>
                    <span>Debug console initialized</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Cache Management Tab -->
        <div id="cache" class="tab-content">
          <div class="section">
            <div class="section-header">
              <div class="section-title">üßπ Cache Management System</div>
            </div>
            <div class="section-body">
              <div class="metrics-grid">
                <div class="metric-card">
                  <div class="metric-header">
                    <div
                      class="metric-icon"
                      style="background: #dcfce7; color: #166534"
                    >
                      üíæ
                    </div>
                    <div class="metric-title">localStorage</div>
                  </div>
                  <div class="metric-value" id="localstorage-size">-- KB</div>
                  <div class="metric-description">Local storage usage</div>
                </div>

                <div class="metric-card">
                  <div class="metric-header">
                    <div
                      class="metric-icon"
                      style="background: #dbeafe; color: #1e40af"
                    >
                      ‚ö°
                    </div>
                    <div class="metric-title">sessionStorage</div>
                  </div>
                  <div class="metric-value" id="sessionstorage-size">-- KB</div>
                  <div class="metric-description">Session storage usage</div>
                </div>

                <div class="metric-card">
                  <div class="metric-header">
                    <div
                      class="metric-icon"
                      style="background: #fef3c7; color: #92400e"
                    >
                      üîß
                    </div>
                    <div class="metric-title">Service Worker</div>
                  </div>
                  <div class="metric-value" id="sw-cache-size">-- KB</div>
                  <div class="metric-description">Service worker cache</div>
                </div>

                <div class="metric-card">
                  <div class="metric-header">
                    <div
                      class="metric-icon"
                      style="background: #f3e8ff; color: #7c3aed"
                    >
                      üìä
                    </div>
                    <div class="metric-title">Total Cache</div>
                  </div>
                  <div class="metric-value" id="total-cache-size">-- KB</div>
                  <div class="metric-description">Combined cache size</div>
                </div>
              </div>

              <div class="test-controls">
                <button class="btn btn-primary" onclick="analyzeCacheUsage()">
                  üìä Analyze Usage
                </button>
                <button class="btn btn-warning" onclick="clearSpecificCache()">
                  üéØ Selective Clear
                </button>
                <button class="btn btn-danger" onclick="clearAllCache()">
                  üóëÔ∏è Clear All Cache
                </button>
                <button class="btn btn-secondary" onclick="optimizeCache()">
                  ‚ö° Optimize Cache
                </button>
              </div>

              <div id="cache-details" class="console" style="margin-top: 25px">
                <div class="console-header">
                  <div class="console-title">Cache Details</div>
                </div>
                <div id="cache-breakdown">
                  <!-- Cache breakdown will be populated here -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- System Info Tab -->
        <div id="system" class="tab-content">
          <div class="section">
            <div class="section-header">
              <div class="section-title">‚öôÔ∏è System Information</div>
            </div>
            <div class="section-body">
              <div class="metrics-grid">
                <div class="metric-card">
                  <div class="metric-header">
                    <div
                      class="metric-icon"
                      style="background: #dcfce7; color: #166534"
                    >
                      üèóÔ∏è
                    </div>
                    <div class="metric-title">Build Info</div>
                  </div>
                  <div class="metric-value" style="font-size: 1.2rem">
                    BUILD_TIME_PLACEHOLDER
                  </div>
                  <div class="metric-description">Last build timestamp</div>
                </div>

                <div class="metric-card">
                  <div class="metric-header">
                    <div
                      class="metric-icon"
                      style="background: #dbeafe; color: #1e40af"
                    >
                      üåê
                    </div>
                    <div class="metric-title">Environment</div>
                  </div>
                  <div class="metric-value" style="font-size: 1.5rem">
                    ENVIRONMENT_PLACEHOLDER
                  </div>
                  <div class="metric-description">Current environment</div>
                </div>

                <div class="metric-card">
                  <div class="metric-header">
                    <div
                      class="metric-icon"
                      style="background: #fef3c7; color: #92400e"
                    >
                      üîó
                    </div>
                    <div class="metric-title">API URL</div>
                  </div>
                  <div class="metric-value" style="font-size: 1rem">
                    API_URL_PLACEHOLDER
                  </div>
                  <div class="metric-description">Current API endpoint</div>
                </div>

                <div class="metric-card">
                  <div class="metric-header">
                    <div
                      class="metric-icon"
                      style="background: #f3e8ff; color: #7c3aed"
                    >
                      üñ•Ô∏è
                    </div>
                    <div class="metric-title">Browser</div>
                  </div>
                  <div
                    class="metric-value"
                    id="browser-info"
                    style="font-size: 1rem"
                  >
                    --
                  </div>
                  <div class="metric-description">Browser information</div>
                </div>
              </div>

              <div class="test-controls">
                <button
                  class="btn btn-primary"
                  onclick="runSystemDiagnostics()"
                >
                  üîç Run Diagnostics
                </button>
                <button class="btn btn-success" onclick="checkCompatibility()">
                  ‚úÖ Check Compatibility
                </button>
                <button class="btn btn-warning" onclick="generateReport()">
                  üìã Generate Report
                </button>
                <button
                  class="btn btn-secondary"
                  onclick="downloadSystemInfo()"
                >
                  üíæ Download Info
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // üöÄ Advanced API Debug Console
      // Enhanced debugging and monitoring system for Pardis Client

      class AdvancedDebugConsole {
        constructor() {
          this.API_BASE_URL = "API_URL_PLACEHOLDER";
          this.VERSION_KEY = "app-version";
          this.APP_VERSION = "VERSION_PLACEHOLDER";
          this.startTime = Date.now();
          this.requestCount = 0;
          this.errorCount = 0;
          this.responseTimeHistory = [];
          this.isMonitoring = true;
          this.logs = [];

          // API Endpoints configuration
          this.endpoints = [
            {
              name: "Health Check",
              method: "GET",
              url: "/health",
              description: "ÿ®ÿ±ÿ±ÿ≥€å Ÿàÿ∂ÿπ€åÿ™ ÿ≥ŸÑÿßŸÖÿ™ API",
              category: "System",
            },
            {
              name: "Get Courses",
              method: "GET",
              url: "/courses",
              description: "ÿØÿ±€åÿßŸÅÿ™ ŸÑ€åÿ≥ÿ™ ÿ™ŸÖÿßŸÖ ÿØŸàÿ±Ÿá‚ÄåŸáÿß",
              category: "Education",
            },
            {
              name: "Get Categories",
              method: "GET",
              url: "/categories",
              description: "ÿØÿ±€åÿßŸÅÿ™ ÿØÿ≥ÿ™Ÿá‚Äåÿ®ŸÜÿØ€å‚ÄåŸáÿß€å ÿØŸàÿ±Ÿá‚ÄåŸáÿß",
              category: "Education",
            },
            {
              name: "User Profile",
              method: "GET",
              url: "/auth/me",
              description: "ÿØÿ±€åÿßŸÅÿ™ ÿßÿ∑ŸÑÿßÿπÿßÿ™ Ÿæÿ±ŸàŸÅÿß€åŸÑ ⁄©ÿßÿ±ÿ®ÿ±",
              category: "Authentication",
              requiresAuth: true,
            },
            {
              name: "Login",
              method: "POST",
              url: "/auth/login",
              description: "Ÿàÿ±ŸàÿØ ⁄©ÿßÿ±ÿ®ÿ± ÿ®Ÿá ÿ≥€åÿ≥ÿ™ŸÖ",
              category: "Authentication",
            },
            {
              name: "Get Instructors",
              method: "GET",
              url: "/instructors",
              description: "ÿØÿ±€åÿßŸÅÿ™ ŸÑ€åÿ≥ÿ™ ŸÖÿØÿ±ÿ≥ÿßŸÜ",
              category: "Education",
            },
            {
              name: "Get Stories",
              method: "GET",
              url: "/stories",
              description: "ÿØÿ±€åÿßŸÅÿ™ ÿØÿßÿ≥ÿ™ÿßŸÜ‚ÄåŸáÿß€å ŸÖŸàŸÅŸÇ€åÿ™",
              category: "Content",
            },
            {
              name: "Get Hero Slides",
              method: "GET",
              url: "/hero-slides",
              description: "ÿØÿ±€åÿßŸÅÿ™ ÿßÿ≥ŸÑÿß€åÿØŸáÿß€å ÿµŸÅÿ≠Ÿá ÿßÿµŸÑ€å",
              category: "Content",
            },
          ];

          this.init();
        }

        async init() {
          this.log("üöÄ Advanced Debug Console initialized", "info");
          this.updateSystemInfo();
          this.startRealTimeMonitoring();
          this.renderEndpoints();
          await this.runInitialHealthCheck();
          this.calculateCacheMetrics();
        }

        // üìä Logging System
        log(message, level = "info", data = null) {
          const timestamp = new Date().toLocaleTimeString("fa-IR");
          const logEntry = {
            timestamp,
            level,
            message,
            data,
          };

          this.logs.push(logEntry);

          if (this.isMonitoring) {
            this.updateConsole(logEntry);
          }

          // Console output for debugging
          const consoleMethod =
            level === "error" ? "error" : level === "warning" ? "warn" : "log";
          console[consoleMethod](`[${timestamp}] ${message}`, data || "");
        }

        updateConsole(logEntry) {
          const consoleOutput = document.getElementById("console-output");
          if (!consoleOutput) return;

          const logElement = document.createElement("div");
          logElement.className = "log-entry";

          const levelClass = `log-${logEntry.level}`;
          const icon = this.getLogIcon(logEntry.level);

          logElement.innerHTML = `
            <span class="log-timestamp">[${logEntry.timestamp}]</span>
            <span class="log-level ${levelClass}">${icon} ${logEntry.level.toUpperCase()}</span>
            <span>${logEntry.message}</span>
          `;

          consoleOutput.appendChild(logElement);
          consoleOutput.scrollTop = consoleOutput.scrollHeight;

          // Keep only last 100 entries
          while (consoleOutput.children.length > 100) {
            consoleOutput.removeChild(consoleOutput.firstChild);
          }
        }

        getLogIcon(level) {
          const icons = {
            info: "‚ÑπÔ∏è",
            success: "‚úÖ",
            warning: "‚ö†Ô∏è",
            error: "‚ùå",
          };
          return icons[level] || "üìù";
        }

        // üîÑ Real-time Monitoring
        startRealTimeMonitoring() {
          // Update status every 5 seconds
          setInterval(() => {
            this.updateStatusBar();
            this.updateUptime();
          }, 5000);

          // Update metrics every 30 seconds
          setInterval(() => {
            this.calculateCacheMetrics();
          }, 30000);
        }

        updateStatusBar() {
          const now = new Date().toLocaleTimeString("fa-IR");
          document.getElementById("last-update").textContent = now;
          document.getElementById("request-count").textContent =
            this.requestCount;

          if (this.responseTimeHistory.length > 0) {
            const avgTime = Math.round(
              this.responseTimeHistory.reduce((a, b) => a + b, 0) /
                this.responseTimeHistory.length
            );
            document.getElementById(
              "response-time"
            ).textContent = `${avgTime} ms`;
            document.getElementById(
              "avg-response"
            ).textContent = `${avgTime} ms`;
          }
        }

        updateUptime() {
          const uptime = Date.now() - this.startTime;
          const hours = Math.floor(uptime / (1000 * 60 * 60));
          const minutes = Math.floor((uptime % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((uptime % (1000 * 60)) / 1000);

          const uptimeStr = `${hours.toString().padStart(2, "0")}:${minutes
            .toString()
            .padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;
          document.getElementById("uptime").textContent = uptimeStr;
        }

        // üè• Health Check System
        async runInitialHealthCheck() {
          this.log("üè• Running initial health check...", "info");
          await this.runHealthCheck();
        }

        async runHealthCheck() {
          const healthLoading = document.getElementById("health-loading");
          if (healthLoading) healthLoading.style.display = "inline-block";

          try {
            const startTime = Date.now();
            const response = await this.makeRequest("GET", "/health");
            const responseTime = Date.now() - startTime;

            this.responseTimeHistory.push(responseTime);
            if (this.responseTimeHistory.length > 10) {
              this.responseTimeHistory.shift();
            }

            if (response.success) {
              this.log("‚úÖ Health check passed", "success", response.data);
              document.getElementById("api-status").textContent = "Healthy";
              document.getElementById("health-score").textContent = "100%";
              this.updateSuccessRate();
            } else {
              throw new Error(response.error);
            }
          } catch (error) {
            this.log(`‚ùå Health check failed: ${error.message}`, "error");
            document.getElementById("api-status").textContent = "Unhealthy";
            document.getElementById("health-score").textContent = "0%";
            this.errorCount++;
          } finally {
            if (healthLoading) healthLoading.style.display = "none";
          }
        }

        // üß™ API Testing System
        async testAllEndpoints() {
          const testLoading = document.getElementById("test-loading");
          if (testLoading) testLoading.style.display = "inline-block";

          this.log("üß™ Starting comprehensive API test...", "info");

          let successCount = 0;
          let totalTests = this.endpoints.length;

          for (const endpoint of this.endpoints) {
            try {
              this.log(`Testing ${endpoint.name}...`, "info");
              const result = await this.testEndpoint(endpoint);

              if (result.success) {
                successCount++;
                this.log(
                  `‚úÖ ${endpoint.name} - OK (${result.responseTime}ms)`,
                  "success"
                );
              } else {
                this.log(
                  `‚ùå ${endpoint.name} - Failed: ${result.error}`,
                  "error"
                );
              }
            } catch (error) {
              this.log(
                `‚ùå ${endpoint.name} - Error: ${error.message}`,
                "error"
              );
            }
          }

          const successRate = Math.round((successCount / totalTests) * 100);
          this.log(
            `üéØ Test completed: ${successCount}/${totalTests} passed (${successRate}%)`,
            "info"
          );

          if (testLoading) testLoading.style.display = "none";
        }

        async testEndpoint(endpoint) {
          const startTime = Date.now();

          try {
            const response = await this.makeRequest(
              endpoint.method,
              endpoint.url
            );
            const responseTime = Date.now() - startTime;

            return {
              success: response.success,
              responseTime,
              data: response.data,
              error: response.error,
            };
          } catch (error) {
            return {
              success: false,
              responseTime: Date.now() - startTime,
              error: error.message,
            };
          }
        }

        // üåê HTTP Request Handler
        async makeRequest(method, url, data = null) {
          this.requestCount++;

          const fullUrl = `${this.API_BASE_URL}${url}`;
          const options = {
            method,
            headers: {
              "Content-Type": "application/json",
              Accept: "application/json",
            },
          };

          // Add auth token if available
          const token = localStorage.getItem("token");
          if (token) {
            options.headers.Authorization = `Bearer ${token}`;
          }

          if (
            data &&
            (method === "POST" || method === "PUT" || method === "PATCH")
          ) {
            options.body = JSON.stringify(data);
          }

          try {
            const response = await fetch(fullUrl, options);
            const responseData = await response.json();

            if (response.ok) {
              return { success: true, data: responseData };
            } else {
              return {
                success: false,
                error: `${response.status} ${response.statusText}`,
              };
            }
          } catch (error) {
            this.errorCount++;
            return { success: false, error: error.message };
          }
        }

        // üìä Cache Management System
        async calculateCacheMetrics() {
          try {
            const localStorage_size = this.calculateStorageSize(localStorage);
            const sessionStorage_size =
              this.calculateStorageSize(sessionStorage);
            const total_size = localStorage_size + sessionStorage_size;

            // Update UI
            document.getElementById("localstorage-size").textContent = `${(
              localStorage_size / 1024
            ).toFixed(2)} KB`;
            document.getElementById("sessionstorage-size").textContent = `${(
              sessionStorage_size / 1024
            ).toFixed(2)} KB`;
            document.getElementById("total-cache-size").textContent = `${(
              total_size / 1024
            ).toFixed(2)} KB`;
            document.getElementById("cache-size-display").textContent = `${(
              total_size / 1024
            ).toFixed(2)} KB`;

            // Service Worker cache (if available)
            if ("caches" in window) {
              const cacheNames = await caches.keys();
              let swCacheSize = 0;
              // Estimate SW cache size (actual calculation is complex)
              document.getElementById("sw-cache-size").textContent = `${(
                swCacheSize / 1024
              ).toFixed(2)} KB`;
            }

            this.updateCacheBreakdown();
          } catch (error) {
            this.log(`‚ùå Cache calculation failed: ${error.message}`, "error");
          }
        }

        calculateStorageSize(storage) {
          let total = 0;
          for (let key in storage) {
            if (storage.hasOwnProperty(key)) {
              total += storage[key].length + key.length;
            }
          }
          return total;
        }

        updateCacheBreakdown() {
          const breakdown = document.getElementById("cache-breakdown");
          if (!breakdown) return;

          let html =
            "<div class='log-entry'><strong>Cache Breakdown:</strong></div>";

          // localStorage items
          for (let key in localStorage) {
            if (localStorage.hasOwnProperty(key)) {
              const size = (localStorage[key].length / 1024).toFixed(2);
              html += `<div class='log-entry'>${key}: ${size} KB</div>`;
            }
          }

          breakdown.innerHTML = html;
        }

        async clearAllCache() {
          if (!confirm("ÿ¢€åÿß ŸÖÿ∑ŸÖÿ¶ŸÜ Ÿáÿ≥ÿ™€åÿØ ⁄©Ÿá ŸÖ€å‚ÄåÿÆŸàÿßŸá€åÿØ ÿ™ŸÖÿßŸÖ ⁄©ÿ¥ ÿ±ÿß Ÿæÿß⁄© ⁄©ŸÜ€åÿØÿü"))
            return;

          try {
            this.log("üßπ Clearing all cache...", "info");

            // Clear localStorage
            localStorage.clear();

            // Clear sessionStorage
            sessionStorage.clear();

            // Clear Service Worker cache
            if ("caches" in window) {
              const cacheNames = await caches.keys();
              await Promise.all(cacheNames.map((name) => caches.delete(name)));
            }

            this.log("‚úÖ All cache cleared successfully", "success");
            setTimeout(() => window.location.reload(), 1000);
          } catch (error) {
            this.log(`‚ùå Cache clearing failed: ${error.message}`, "error");
          }
        }

        // üéØ UI Management
        renderEndpoints() {
          const container = document.getElementById("endpoints-list");
          if (!container) return;

          const categories = [
            ...new Set(this.endpoints.map((e) => e.category)),
          ];

          categories.forEach((category) => {
            const categoryEndpoints = this.endpoints.filter(
              (e) => e.category === category
            );

            const categorySection = document.createElement("div");
            categorySection.innerHTML = `
              <h3 style="margin: 30px 0 20px 0; color: var(--primary); font-size: 1.3rem;">
                üìÅ ${category}
              </h3>
            `;

            categoryEndpoints.forEach((endpoint) => {
              const endpointCard = this.createEndpointCard(endpoint);
              categorySection.appendChild(endpointCard);
            });

            container.appendChild(categorySection);
          });
        }

        createEndpointCard(endpoint) {
          const card = document.createElement("div");
          card.className = "endpoint-card";

          const methodClass = `method-${endpoint.method.toLowerCase()}`;
          const authBadge = endpoint.requiresAuth
            ? '<span class="status warning">üîê Auth Required</span>'
            : "";

          card.innerHTML = `
            <div class="endpoint-header">
              <div style="display: flex; align-items: center; gap: 15px;">
                <span class="endpoint-method ${methodClass}">${endpoint.method}</span>
                <span class="endpoint-url">${endpoint.url}</span>
                ${authBadge}
              </div>
              <button class="btn btn-primary" onclick="debugConsole.testSingleEndpoint('${endpoint.url}', '${endpoint.method}')">
                üß™ Test
              </button>
            </div>
            <div class="endpoint-body">
              <div class="endpoint-description">${endpoint.description}</div>
            </div>
          `;

          return card;
        }

        async testSingleEndpoint(url, method) {
          this.log(`üß™ Testing ${method} ${url}...`, "info");

          try {
            const result = await this.testEndpoint({
              url,
              method,
              name: `${method} ${url}`,
            });

            if (result.success) {
              this.log(
                `‚úÖ ${method} ${url} - Success (${result.responseTime}ms)`,
                "success",
                result.data
              );
            } else {
              this.log(
                `‚ùå ${method} ${url} - Failed: ${result.error}`,
                "error"
              );
            }
          } catch (error) {
            this.log(`‚ùå ${method} ${url} - Error: ${error.message}`, "error");
          }
        }

        updateSuccessRate() {
          const successRate =
            this.requestCount > 0
              ? Math.round(
                  ((this.requestCount - this.errorCount) / this.requestCount) *
                    100
                )
              : 100;
          document.getElementById(
            "success-rate"
          ).textContent = `${successRate}%`;
          document.getElementById("error-count").textContent = this.errorCount;
        }

        updateSystemInfo() {
          // Browser info
          const browserInfo = `${navigator.userAgent
            .split(" ")
            .slice(-2)
            .join(" ")}`;
          document.getElementById("browser-info").textContent = browserInfo;
        }

        // üì• Export Functions
        exportLogs() {
          const logsData = {
            timestamp: new Date().toISOString(),
            version: this.APP_VERSION,
            apiUrl: this.API_BASE_URL,
            logs: this.logs,
            metrics: {
              requestCount: this.requestCount,
              errorCount: this.errorCount,
              uptime: Date.now() - this.startTime,
              responseTimeHistory: this.responseTimeHistory,
            },
          };

          const blob = new Blob([JSON.stringify(logsData, null, 2)], {
            type: "application/json",
          });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = `debug-logs-${
            new Date().toISOString().split("T")[0]
          }.json`;
          a.click();
          URL.revokeObjectURL(url);

          this.log("üì• Logs exported successfully", "success");
        }

        // üîß Utility Functions
        clearConsole() {
          const consoleOutput = document.getElementById("console-output");
          if (consoleOutput) {
            consoleOutput.innerHTML = `
              <div class="log-entry">
                <span class="log-timestamp">[${new Date().toLocaleTimeString(
                  "fa-IR"
                )}]</span>
                <span class="log-level log-info">‚ÑπÔ∏è INFO</span>
                <span>Console cleared</span>
              </div>
            `;
          }
          this.logs = [];
        }

        pauseConsole() {
          this.isMonitoring = !this.isMonitoring;
          const btn = event.target;
          btn.textContent = this.isMonitoring ? "Pause" : "Resume";
          this.log(
            `üìä Console monitoring ${this.isMonitoring ? "resumed" : "paused"}`,
            "info"
          );
        }
      }

      // üéØ Tab Management
      function switchTab(tabName) {
        // Hide all tab contents
        document.querySelectorAll(".tab-content").forEach((content) => {
          content.classList.remove("active");
        });

        // Remove active class from all tabs
        document.querySelectorAll(".tab").forEach((tab) => {
          tab.classList.remove("active");
        });

        // Show selected tab content
        document.getElementById(tabName).classList.add("active");

        // Add active class to clicked tab
        event.target.classList.add("active");

        debugConsole.log(`üìã Switched to ${tabName} tab`, "info");
      }

      // üöÄ Global Functions (called from HTML)
      function runHealthCheck() {
        debugConsole.runHealthCheck();
      }

      function testAllEndpoints() {
        debugConsole.testAllEndpoints();
      }

      function clearAllCache() {
        debugConsole.clearAllCache();
      }

      function exportLogs() {
        debugConsole.exportLogs();
      }

      function clearConsole() {
        debugConsole.clearConsole();
      }

      function pauseConsole() {
        debugConsole.pauseConsole();
      }

      function analyzeCacheUsage() {
        debugConsole.calculateCacheMetrics();
        debugConsole.log("üìä Cache analysis completed", "success");
      }

      function clearSpecificCache() {
        // Implementation for selective cache clearing
        debugConsole.log(
          "üéØ Selective cache clearing not implemented yet",
          "warning"
        );
      }

      function optimizeCache() {
        // Implementation for cache optimization
        debugConsole.log(
          "‚ö° Cache optimization not implemented yet",
          "warning"
        );
      }

      function runSystemDiagnostics() {
        debugConsole.log("üîç Running system diagnostics...", "info");
        debugConsole.updateSystemInfo();
        debugConsole.calculateCacheMetrics();
        debugConsole.runHealthCheck();
      }

      function checkCompatibility() {
        debugConsole.log("‚úÖ Checking browser compatibility...", "info");

        const features = {
          "Service Worker": "serviceWorker" in navigator,
          "Local Storage": "localStorage" in window,
          "Session Storage": "sessionStorage" in window,
          "Fetch API": "fetch" in window,
          "Cache API": "caches" in window,
        };

        Object.entries(features).forEach(([feature, supported]) => {
          const status = supported ? "‚úÖ" : "‚ùå";
          debugConsole.log(
            `${status} ${feature}: ${
              supported ? "Supported" : "Not Supported"
            }`,
            supported ? "success" : "warning"
          );
        });
      }

      function generateReport() {
        debugConsole.log("üìã Generating system report...", "info");
        // Implementation for generating comprehensive report
      }

      function downloadSystemInfo() {
        const systemInfo = {
          timestamp: new Date().toISOString(),
          userAgent: navigator.userAgent,
          language: navigator.language,
          platform: navigator.platform,
          cookieEnabled: navigator.cookieEnabled,
          onLine: navigator.onLine,
          screen: {
            width: screen.width,
            height: screen.height,
            colorDepth: screen.colorDepth,
          },
          window: {
            innerWidth: window.innerWidth,
            innerHeight: window.innerHeight,
          },
        };

        const blob = new Blob([JSON.stringify(systemInfo, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `system-info-${
          new Date().toISOString().split("T")[0]
        }.json`;
        a.click();
        URL.revokeObjectURL(url);

        debugConsole.log("üíæ System info downloaded", "success");
      }

      // üöÄ Initialize Debug Console
      let debugConsole;

      document.addEventListener("DOMContentLoaded", function () {
        debugConsole = new AdvancedDebugConsole();

        // Make it globally accessible for debugging
        window.debugConsole = debugConsole;
      });
    </script>
  </body>
</html>
