<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ØªØ³Øª API Configuration</title>
    <style>
      body {
        font-family: "Vazirmatn", sans-serif;
        padding: 20px;
        background: #f8fafc;
        direction: rtl;
      }
      .container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .status {
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
      }
      .success {
        background: #d1fae5;
        color: #065f46;
      }
      .error {
        background: #fee2e2;
        color: #991b1b;
      }
      .info {
        background: #dbeafe;
        color: #1e40af;
      }
      button {
        background: #1c39bb;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background: #1530a3;
      }
      pre {
        background: #f1f5f9;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ”§ ØªØ³Øª ØªÙ†Ø¸ÛŒÙ…Ø§Øª API</h1>
      <p>Ø§ÛŒÙ† ØµÙØ­Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øª ØªÙ†Ø¸ÛŒÙ…Ø§Øª API Ø¯Ø± production Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</p>

      <div id="config-info" class="status info">
        <h3>ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ¹Ù„ÛŒ:</h3>
        <div id="config-details"></div>
      </div>

      <button onclick="testAPI()">ØªØ³Øª Ø§ØªØµØ§Ù„ API</button>
      <button onclick="testCategories()">ØªØ³Øª Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</button>
      <button onclick="clearResults()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬</button>

      <div id="results"></div>
    </div>

    <script>
      // Ù†Ù…Ø§ÛŒØ´ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
      function showConfig() {
        const configDiv = document.getElementById("config-details");
        const config = {
          "Current URL": window.location.href,
          "User Agent": navigator.userAgent,
          Environment: "Production Test",
          "Expected API URL": "https://api.pardistous.ir/api",
        };

        let html = "<pre>";
        for (const [key, value] of Object.entries(config)) {
          html += `${key}: ${value}\n`;
        }
        html += "</pre>";

        configDiv.innerHTML = html;
      }

      // ØªØ³Øª Ø§ØªØµØ§Ù„ API
      async function testAPI() {
        const resultsDiv = document.getElementById("results");
        const apiUrl = "https://api.pardistous.ir/api";

        addResult("info", `ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡: ${apiUrl}`);

        try {
          const response = await fetch(`${apiUrl}/home/categories`);
          const data = await response.json();

          if (response.ok) {
            addResult("success", `âœ… Ø§ØªØµØ§Ù„ Ù…ÙˆÙÙ‚! ÙˆØ¶Ø¹ÛŒØª: ${response.status}`);
            addResult(
              "info",
              `ğŸ“Š ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§: ${
                data.data ? data.data.length : "Ù†Ø§Ù…Ø´Ø®Øµ"
              }`
            );
          } else {
            addResult("error", `âŒ Ø®Ø·Ø§ Ø¯Ø± API! ÙˆØ¶Ø¹ÛŒØª: ${response.status}`);
          }
        } catch (error) {
          addResult("error", `âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„: ${error.message}`);
        }
      }

      // ØªØ³Øª Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§
      async function testCategories() {
        const resultsDiv = document.getElementById("results");
        const apiUrl = "https://api.pardistous.ir/api";

        addResult("info", "ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§...");

        try {
          const response = await fetch(`${apiUrl}/home/categories`);
          const data = await response.json();

          if (response.ok && data.data) {
            addResult("success", `âœ… Ø¯Ø±ÛŒØ§ÙØª Ù…ÙˆÙÙ‚! ØªØ¹Ø¯Ø§Ø¯: ${data.data.length}`);

            // Ù†Ù…Ø§ÛŒØ´ Ø§ÙˆÙ„ÛŒÙ† 3 Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ
            const preview = data.data
              .slice(0, 3)
              .map((cat) => cat.name)
              .join(", ");
            addResult("info", `ğŸ“‹ Ù†Ù…ÙˆÙ†Ù‡ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§: ${preview}`);
          } else {
            addResult("error", "âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§");
          }
        } catch (error) {
          addResult("error", `âŒ Ø®Ø·Ø§: ${error.message}`);
        }
      }

      // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù†ØªÛŒØ¬Ù‡
      function addResult(type, message) {
        const resultsDiv = document.getElementById("results");
        const div = document.createElement("div");
        div.className = `status ${type}`;
        div.innerHTML = `<strong>${new Date().toLocaleTimeString(
          "fa-IR"
        )}:</strong> ${message}`;
        resultsDiv.appendChild(div);
      }

      // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬
      function clearResults() {
        document.getElementById("results").innerHTML = "";
      }

      // Ø§Ø¬Ø±Ø§ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±
      window.onload = function () {
        showConfig();
        addResult("info", "ğŸš€ ØµÙØ­Ù‡ ØªØ³Øª API Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª");
      };
    </script>
  </body>
</html>
